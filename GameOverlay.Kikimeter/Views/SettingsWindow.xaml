<Window x:Class="GameOverlay.Kikimeter.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d"
        d:DesignHeight="700" d:DesignWidth="900"
        Title="ParamÃ¨tres"
        Width="900"
        Height="670"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="CanResize"
        MinWidth="800"
        MinHeight="600" Cursor="">
    <Window.Resources>
        <Style x:Key="DialogButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource SectionBackgroundBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource CyanAccentBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource CyanAccentBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="10,5" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#FFFFFFFF" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5" />
                    <Setter Property="Cursor" Value="Arrow" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Window.Background>
        <ImageBrush ImageSource="/GameOverlay.Kikimeter;component/Views/loot.png" Stretch="Fill"/>
    </Window.Background>
    <Border
            BorderThickness="1"
            CornerRadius="10"
            Padding="0"
            SnapsToDevicePixels="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="698"/>
            </Grid.RowDefinitions>

            <!-- En-tÃªte avec titre et bouton fermer -->
            <Grid Grid.Row="0"
                  Margin="15,49,15,621">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <!-- IcÃ´ne de dÃ©placement (petite croix/grip) -->
                <Viewbox Grid.Column="0"
                         Width="16"
                         Height="16"
                         VerticalAlignment="Center"
                         Margin="0,0,12,0"
                         Cursor="SizeAll"
                         MouseLeftButtonDown="DragHandle_MouseLeftButtonDown"
                         MouseMove="DragHandle_MouseMove"
                         MouseLeftButtonUp="DragHandle_MouseLeftButtonUp">
                    <Canvas Width="24" Height="24">
                        <Path Data="M3,7H5V9H3M7,7H9V9H7M11,7H13V9H11M3,11H5V13H3M7,11H9V13H7M11,11H13V13H11M3,15H5V17H3M7,15H9V17H7M11,15H13V17H11Z"
                              Fill="{DynamicResource CyanAccentBrush}" />
                    </Canvas>
                </Viewbox>
                <Image Grid.Column="1"
                       Source="/GameOverlay.Kikimeter;component/Views/Assets/kikimeter/croix_deplacement.png"
                       Width="20"
                       Height="20"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"
                       Cursor="SizeAll"
                       MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
                       Stretch="Uniform" Margin="12,0,0,0"/>
                <Image Grid.Column="2"
                       Source="/GameOverlay.Kikimeter;component/Views/Assets/utilities/fermeture.png"
                       Width="28"
                       Height="28"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Right"
                       Cursor="Hand"
                       MouseLeftButtonDown="CloseButton_Click"
                       Stretch="Uniform" Margin="0,5,39,0"/>
            </Grid>

            <!-- Contenu principal avec deux colonnes -->
            <Grid
                  Margin="15,92,15,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="868"/>
                </Grid.ColumnDefinitions>

                <!-- Colonne gauche : Chemins de logs -->
                <Grid Grid.Column="0" Margin="-1,-4,433,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="591.08"/>
                    </Grid.RowDefinitions>

                    <!-- Section Kikimeter Log -->
                    <Border Grid.Row="0"
                            BorderThickness="0,0,0,1"
                            Padding="0,0,0,20"
                            Margin="0,0,-1,240">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Image Grid.Row="0"
                                   Source="/GameOverlay.Kikimeter;component/Views/NP-SearchBar-1.png"
                                   Width="88"
                                   Height="119"
                                   HorizontalAlignment="Left"
                                   Margin="64,0,0,8">
                                <Image.OpacityMask>
                                    <ImageBrush ImageSource="/GameOverlay.Kikimeter;component/Views/0.png" Stretch="Fill"/>
                                </Image.OpacityMask>
                            </Image>
                            <StackPanel Grid.Row="1"
                                        HorizontalAlignment="Left" 
                                        Width="426" 
                                        Margin="-1,0,0,0">
                                <TextBlock Text="Log Kikimeter (wakfu.log)"
                                           FontSize="13"
                                           FontWeight="Bold"
                                           Foreground="#FF4E421F"
                                           Margin="50,0,0,10" />
                                <TextBlock Text="Chemin du fichier de log principal Wakfu pour l'analyse des combats:"
                                       FontSize="11"
                                       Foreground="#FF4E421F"
                                       Margin="45,0,0,8"
                                       TextWrapping="Wrap" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="KikimeterLogPathTextBox"
                                         Grid.Column="0"
                                         Height="40"
                                         VerticalContentAlignment="Center"
                                         Margin="42,0,10,0"
                                         Text="{Binding KikimeterLogPath, Mode=TwoWay}" BorderBrush="#FF6E5C2A" SelectionBrush="#FF4E421F" SelectionTextBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                        <TextBox.CaretBrush>
                                            <SolidColorBrush Color="#FF4E421F" Opacity="0.5"/>
                                        </TextBox.CaretBrush>
                                        <TextBox.Background>
                                            <SolidColorBrush Color="#FF6E5C2A" Opacity="0.5"/>
                                        </TextBox.Background>
                                    </TextBox>
                                    <Button Grid.Column="1"
                                        Content="ðŸ“ Parcourir"
                                        Width="100"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Padding="5,0"
                                        Click="BrowseKikimeterLogPath_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                        <Button.Background>
                                            <SolidColorBrush Color="#FF6E5C2A" Opacity="0.25"/>
                                        </Button.Background>
                                    </Button>
                                </Grid>
                            <StackPanel Orientation="Horizontal"
                                       Margin="44,8,0,0"
                                       HorizontalAlignment="Left">
                                <Button Content="Steam"
                                        Width="100"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Margin="0,0,10,0"
                                        Click="AutoDetectSteamLogPath_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.25"/>
                                    </Button.Background>
                                </Button>
                                <Button Content="Ankama Launcher"
                                        Width="130"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Click="AutoDetectAnkamaLogPath_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.25"/>
                                    </Button.Background>
                                </Button>
                            </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Section Loot Log -->
                    <Border
                            BorderThickness="0,0,0,1"
                            Padding="0,0,0,20"
                            Margin="0,267,0,170">
                        <StackPanel>
                            <TextBlock Text="Log Loot (wakfu_chat.log)"
                                       FontSize="13"
                                       FontWeight="Bold"
                                       Foreground="#FF6E5C2A"
                                       Margin="44,0,0,10" Cursor="" />
                            <TextBlock Text="Chemin du fichier de log de chat Wakfu pour le suivi du butin:"
                                       FontSize="11"
                                       Foreground="#FF4E421F"
                                       Margin="44,0,0,8"
                                       TextWrapping="Wrap" />
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="LootChatLogPathTextBox"
                                         Grid.Column="0"
                                         Height="40"
                                         VerticalContentAlignment="Center"
                                         Margin="43,0,10,0"
                                         Text="{Binding LootChatLogPath, Mode=TwoWay}" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                    <TextBox.CaretBrush>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.5"/>
                                    </TextBox.CaretBrush>
                                    <TextBox.SelectionBrush>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.5"/>
                                    </TextBox.SelectionBrush>
                                    <TextBox.SelectionTextBrush>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.5"/>
                                    </TextBox.SelectionTextBrush>
                                    <TextBox.Background>
                                        <SolidColorBrush Color="#FF6E5C2A" Opacity="0.5"/>
                                    </TextBox.Background>
                                </TextBox>
                                <Button Grid.Column="1"
                                        Content="ðŸ“ Parcourir"
                                        Width="100"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Padding="5,0"
                                        Click="BrowseLootChatLogPath_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" Margin="0,0,6,0" >
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                                    </Button.Background>
                                </Button>
                            </Grid>
                            <StackPanel Orientation="Horizontal"
                                       Margin="45,8,0,0"
                                       HorizontalAlignment="Left">
                                <Button Content="Steam"
                                        Width="100"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Margin="0,0,10,0"
                                        Click="AutoDetectSteamLootLogPath_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                                    </Button.Background>
                                </Button>
                                <Button Content="Ankama Launcher"
                                        Width="130"
                                        Height="30"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Click="AutoDetectAnkamaLootLogPath_Click" Foreground="#FF6E5C2A" BorderBrush="#FF6E5C2A" >
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                                    </Button.Background>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Section DÃ©marrage automatique -->
                    <Border
                            BorderThickness="0,0,0,1"
                            Padding="3,0,0,4"
                            Margin="0,441,0,113"
                            Visibility="Visible">
                        <StackPanel Margin="0,-38,0,0">
                            <TextBlock Text="DÃ©marrage automatique"
                                       FontSize="13"
                                       FontWeight="Bold"
                                       Foreground="#FF6E5C2A"
                                       Margin="44,0,0,10"
                                       Visibility="Visible" />
                            <TextBlock Text="DÃ©marrer l'application automatiquement au lancement de Windows:"
                                       FontSize="11"
                                       Foreground="#FF4E421F"
                                       Margin="44,0,0,8"
                                       TextWrapping="Wrap" />
                            <CheckBox x:Name="StartWithWindowsCheckBox"
                                      Content="Activer le dÃ©marrage automatique"
                                      IsChecked="{Binding StartWithWindows, Mode=TwoWay}"
                                      FontSize="11"
                                      Foreground="#FF4E421F"
                                      Margin="44,0,0,0"
                                      VerticalAlignment="Center"
                                      Checked="StartWithWindowsCheckBox_Checked"
                                      Unchecked="StartWithWindowsCheckBox_Unchecked">
                                <CheckBox.Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="CheckBox">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Grid>
                                                            <Image x:Name="ImageEmpty"
                                                                   Source="/GameOverlay.Kikimeter;component/Views/Assets/utilities/checkbox_empty.png"
                                                                   Width="20"
                                                                   Height="20"
                                                                   Stretch="Uniform"
                                                                   Visibility="Visible"
                                                                   Margin="0,0,6,0"/>
                                                            <Image x:Name="ImageFull"
                                                                   Source="/GameOverlay.Kikimeter;component/Views/Assets/utilities/checkbox_full.png"
                                                                   Width="20"
                                                                   Height="20"
                                                                   Stretch="Uniform"
                                                                   Visibility="Collapsed"
                                                                   Margin="0,0,6,0"/>
                                                        </Grid>
                                                        <ContentPresenter VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="ImageEmpty" Property="Visibility" Value="Collapsed"/>
                                                            <Setter TargetName="ImageFull" Property="Visibility" Value="Visible"/>
                                                        </Trigger>
                                                        <Trigger Property="IsChecked" Value="False">
                                                            <Setter TargetName="ImageEmpty" Property="Visibility" Value="Visible"/>
                                                            <Setter TargetName="ImageFull" Property="Visibility" Value="Collapsed"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </CheckBox.Style>
                            </CheckBox>
                        </StackPanel>
                    </Border>

                    <!-- Boutons de validation et reset -->
                    <StackPanel
                                Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom" Cursor="Hand" Margin="0,0,104,82">
                        <Button Content="Reset"
                                Width="100"
                                Style="{StaticResource DialogButtonStyle}"
                                Margin="0,-1,10,-1"
                                ToolTip="RÃ©initialiser les loots, la liste des personnages et l'ordre des personnages"
                                Click="ResetLootButton_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A" >
                            <Button.Background>
                                <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                            </Button.Background>
                        </Button>
                        <Button Content="Valider"
                                Width="90"
                                Style="{StaticResource DialogButtonStyle}"
                                Click="ConfirmLogPaths_Click" Foreground="#FF6E5C2A" BorderBrush="#FF6E5C2A" Cursor="" >
                            <Button.Background>
                                <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                            </Button.Background>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Colonne droite : Ordre des joueurs et Gestion des personnages -->
                <Grid Margin="436,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="591"/>
                    </Grid.RowDefinitions>

                    <!-- Titre Ordre des joueurs -->
                    <TextBlock Grid.Row="0"
                               Text="Ordre des joueurs"
                               FontSize="14"
                               FontWeight="Bold"
                               Foreground="#FF6E5C2A"
                               Margin="15,35,0,539" Cursor="" />

                    <!-- Panneau Ordre des joueurs -->
                    <Grid
                          x:Name="PlayerOrderPanel" Margin="10,54,42,330">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" MinHeight="150"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid>
                                <ListBox x:Name="PlayerListBox"
                                         ItemsSource="{Binding Items}"
                                         BorderBrush="#FF6E5C2A"
                                         BorderThickness="1"
                                         Background="{DynamicResource SectionBackgroundBrush}"
                                         Foreground="#FF6E5C2A"
                                         SelectionChanged="PlayerListBox_SelectionChanged"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         MinHeight="100"
                                         MaxHeight="200"
                                         VerticalAlignment="Stretch">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Margin" Value="0,0,0,2"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ListBoxItem">
                                                    <Border x:Name="Container"
                                                            Background="#33000000"
                                                            BorderBrush="#FF6E5C2A"
                                                            BorderThickness="1"
                                                            CornerRadius="5"
                                                            Padding="8,3">
                                                        <ContentPresenter />
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter TargetName="Container" Property="Background" Value="#266E5C2A"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Display}"
                                                   FontSize="11"
                                                   FontWeight="Normal"
                                                   Foreground="#FF6E5C2A"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <TextBlock x:Name="EmptyListMessage"
                                       Text="Aucun joueur dÃ©tectÃ©. Les joueurs apparaÃ®tront automatiquement lorsqu'ils seront dÃ©tectÃ©s dans les logs de combat."
                                       FontSize="11"
                                       Foreground="#FF6E5C2A"
                                       TextWrapping="Wrap"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Margin="10"
                                       Visibility="Collapsed"/>
                            </Grid>

                            <StackPanel Grid.Column="1"
                                        Margin="10,0,0,0"
                                        VerticalAlignment="Center">
                                <Button x:Name="MoveUpButton"
                                        Content="â–²"
                                        Width="36"
                                        Height="28"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Margin="0,0,0,8"
                                        Click="MoveUpButton_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A">
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF4E421F" Opacity="0.5"/>
                                    </Button.Background>
                                </Button>
                                <Button x:Name="MoveDownButton"
                                        Content="â–¼"
                                        Width="36"
                                        Height="28"
                                        Style="{StaticResource DialogButtonStyle}"
                                        Click="MoveDownButton_Click" Cursor="Hand" Foreground="#FF6E5C2A" BorderBrush="#FF6E5C2A">
                                    <Button.Background>
                                        <SolidColorBrush Color="#FF4E421F" Opacity="0.5"/>
                                    </Button.Background>
                                </Button>
                            </StackPanel>
                        </Grid>

                        <StackPanel Grid.Row="1"
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,15,0,0">
                            <Button Content="RÃ©initialiser"
                                    Width="100"
                                    Style="{StaticResource DialogButtonStyle}"
                                    Margin="0,0,10,0"
                                    Click="ResetPlayerOrder_Click" Foreground="#FF6E5C2A" BorderBrush="#FF6E5C2A">
                                <Button.Background>
                                    <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                                </Button.Background>
                            </Button>
                            <Button Content="Valider"
                                    Width="90"
                                    Style="{StaticResource DialogButtonStyle}"
                                    Click="ConfirmPlayerOrder_Click" BorderBrush="#FF6E5C2A" Foreground="#FF6E5C2A">
                                <Button.Background>
                                    <SolidColorBrush Color="#FF4E421F" Opacity="0.25"/>
                                </Button.Background>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <!-- Titre Gestion des personnages -->
                    <TextBlock
                               Text="Gestion des personnages"
                               FontSize="14"
                               FontWeight="Bold"
                               Foreground="#FF6E5C2A"
                               Margin="13,262,0,310" />

                    <!-- Panneau Gestion des personnages -->
                    <ScrollViewer
                                  x:Name="CharacterManagementPanel"
                                  VerticalScrollBarVisibility="Auto" Margin="10,285,40,40">
                        <StackPanel Margin="0,5,0,5">
                            <TextBlock Text="Les personnages dÃ©tectÃ©s automatiquement dans les logs apparaÃ®tront ici."
                                       FontSize="11"
                                       Foreground="#FF6E5C2A"
                                       Margin="-1,0,0,10"
                                       TextWrapping="Wrap" />
                            <StackPanel x:Name="CharactersListContainer" />
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>

